# 英単語学習Webアプリ 要件定義書

## 概要
英単語学習用のモバイル最適化されたWebアプリケーション。単語帳形式で日本語の意味から英単語を入力する形式で学習し、過去の学習履歴に基づいて効率的な出題を行う。

## 基本機能

### 出題機能
- **出題方式**: 日本語の意味を表示し、ユーザが対応する英単語を入力
- **入力方式**: 完全一致による判定（大文字小文字を区別）
  - 基本的に小文字で管理
  - 月、曜日など固有名詞は頭文字を大文字で管理
- **正解判定**: 複数の正解候補に対応
  - DBに複数の正解パターンを登録可能
  - いずれかの正解パターンに一致すればOK
  - 正誤判定後、類義語がある場合は表示

### セッション機能
- **1セッションあたりの問題数**: 10問
- **出題終了後**: 正誤判定と正しい答えを表示

## データ管理

### 単語データ
- **初期データ**: CSVファイルから読み込み
- **データ構造**: 
  - 日本語の意味
  - 複数の英単語正解候補
  - 類義語情報

### ユーザー管理
- **複数ユーザー対応**: ユーザーごとに学習履歴を分離管理
- **学習履歴記録項目**:
  - 出題回数
  - 最新出題日
  - 正解/不正解の履歴

## 学習アルゴリズム

### 出題優先順位
出題比率: **過去正解:過去不正解:新規 = 2:4:4**
- 過去に正解した単語: 20%
- 過去に間違えた単語: 40%  
- 未出題の新しい単語: 40%

※この比率は今後調整可能

## UI/UX

### 表示機能
- **モバイル最適化**: レスポンシブデザインでスマートフォンに対応
- **学習進捗表示**:
  - セッション終了時の正答率表示
  - 全体進捗: 正解済み単語数 / 登録単語総数

### 画面構成
1. **メイン学習画面**: 問題表示・回答入力
2. **結果画面**: 正誤判定・正答表示・類義語表示
3. **進捗画面**: セッション結果・全体進捗表示

## 技術要件

### データベース
- 単語マスタデータ管理
- ユーザー別学習履歴管理
- CSVインポート機能

### Webアプリケーション
- モバイルファースト設計
- レスポンシブWebデザイン
- セッション管理機能

## 管理機能

### 単語管理API
管理者向けの単語追加・更新機能をAPI形式で提供。

#### 認証方式
- **APIキー認証**: `Authorization: Bearer <API_KEY>`
- 環境変数 `ADMIN_API_KEY` で管理
- 外部からの意図しないアクセスを防止する簡易認証

#### 機能一覧
1. **単語追加機能**
   - 新規単語の登録（日本語の意味 + 英単語の正解候補）
   - 複数正解候補の一括登録
   - 類義語情報の設定
   - データ妥当性チェック（重複チェック、フォーマット検証）

2. **単語更新機能**
   - 既存単語の意味修正
   - 正解候補の置換（既存候補をすべて削除して新規設定）
   - 類義語情報の更新

3. **単語削除機能**
   - **ソフトデリート方式**: `is_active`フラグによる論理削除
   - 既存の学習履歴は保持
   - 出題対象からは除外

#### データ整合性方針
- **学習履歴保護**: 既存の学習履歴に影響を与えない設計
- **トランザクション管理**: 単語と正解候補の整合性を保証
- **正解候補更新**: 既存候補の全置換方式でシンプルに管理

#### API仕様
- **RESTful設計**: 標準的なHTTPメソッド（POST/PUT/DELETE）
- **JSON形式**: リクエスト・レスポンス共にJSON
- **エラーハンドリング**: 統一されたエラーレスポンス形式
- **単発処理**: 1リクエスト1単語の処理（バッチ処理は将来拡張）

## 今後の拡張性
- 出題比率の調整機能
- バッチ処理機能（CSV一括更新）
- 学習統計の詳細分析
- 難易度別カテゴリ分け